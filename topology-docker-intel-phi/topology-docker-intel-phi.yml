tosca_definitions_version: alien_dsl_1_3_0
description: "This archive has been created with alien4cloud."
template_name: PhiRayTracingTemplate
template_version: 0.1.0-SNAPSHOT
template_author: admin

imports:
  - tosca-normative-types:1.0.0-SNAPSHOT
  - cloudlightning-intel-types:0.1.0-SNAPSHOT
  - cl-normative-types:0.1.0-SNAPSHOT
  - docker-types:1.2.0-SNAPSHOT


topology_template:
  inputs:
    host_path:
      type: string
      required: true
      description: "Specifies where the volume is mounted inside the host."
    container_path:
      type: string
      required: true
      description: "Specifies where the volume is mounted inside the container."
  node_templates:
    PhiRayTracingEngine:
      type: cloudlightning.nodes.PhiRayTracingEngine
      properties:
        cpu_share: "0.1"
        mem_share: "512 MB"
        docker_force_pull_image: false
      capabilities:
        raytrace_engine:
          properties:
            docker_bridge_port_mapping: 0
            port: 22
            protocol: tcp
            secure: false
            network_name: PRIVATE
            initiator: source
        scalable:
          properties:
            min_instances: 1
            max_instances: 1
            default_instances: 1
    MIC:
      type: cloudlightning.nodes.MIC
      properties:
        cores: 1
      requirements:
        - attachment:
            node: PhiRayTracingEngine
            capability: cloudlightning.capabilities.AcceleratorAttachment
            relationship: cloudlightning.relationships.MountAccelerator
            properties:
              container_path: { get_input: container_path }
              host_path: { get_input: host_path }
              mode: RO
    RayTracingWebservice:
      type: cloudlightning.nodes.RayTracingWebservice
      properties:
        cpu_share: "0.1"
        mem_share: "512 MB"
        docker_force_pull_image: false
      requirements:
        - raytrace_engine:
            node: PhiRayTracingEngine
            capability: cloudlightning.capabilities.endpoint.docker.RayTracing
            relationship: tosca.relationships.ConnectsTo
      capabilities:
        WebUI_endpoint:
          properties:
            docker_bridge_port_mapping: 0
            port: 3005
            protocol: tcp
            secure: false
            network_name: PRIVATE
            initiator: source
        regiter_endpoint:
          properties:
            docker_bridge_port_mapping: 0
            port: 9393
            protocol: tcp
            secure: false
            network_name: PRIVATE
            initiator: source